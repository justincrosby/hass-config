arrive_home:
  alias: Arrive Home
  sequence:
    - service: lock.unlock
      entity_id: lock.front_door
    - service: switch.turn_on
      entity_id: switch.justins_pc
    - service: script.turn_on
      entity_id: script.switch_to_audio
    - service: script.turn_on
      entity_id: script.play_all_music_conditional
    - service: light.turn_on
      data_template:
        entity_id: light.living_room
        brightness: >
            {% if now().strftime("%H")|int > 23 %}
              100
            {% else %}
              250
            {% endif %}
    - condition: sun
      after: sunset
      after_offset: "+00:20:00"
    - service: light.turn_on
      entity_id: light.living_room_lamp
    - service: light.turn_on
      entity_id: light.fairy_lights
arrive_home_justin:
  alias: Arrive Home Justin
  sequence:
    - service: switch.turn_on
      entity_id: switch.phone_ringer_on
    - condition: or
      conditions:
        - condition: time
          after: "23:00:00"
        - condition: time
          before: "04:00:00"
    - service: switch.turn_on
      entity_id: switch.phone_bedtime
be_right_back:
  alias: Be Right Back
  sequence:
    - service: automation.turn_off
      entity_id: automation.arrive_home_jenni
    - service: automation.turn_off
      entity_id: automation.arrive_home_justin
    - service: automation.turn_off
      entity_id: automation.leave_home_jenni
    - service: automation.turn_off
      entity_id: automation.leave_home_justin
    - delay:
        minutes: 15
    - service: automation.turn_on
      entity_id: automation.arrive_home_jenni
    - service: automation.turn_on
      entity_id: automation.arrive_home_justin
    - service: automation.turn_on
      entity_id: automation.leave_home_jenni
    - service: automation.turn_on
      entity_id: automation.leave_home_justin
wifi_check:
  alias: Wifi Check
  sequence:
    - service: switch.turn_on
      entity_id: switch.phone_wifi_check
    - delay:
        seconds: 30
    - condition: state
      entity_id: device_tracker.justins_phone
      state: 'not_home'
    - service: switch.turn_on
      entity_id: switch.phone_ringer_off
    - condition: state
      entity_id: device_tracker.jennis_phone
      state: 'not_home'
    - service: script.turn_on
      entity_id: script.shutoff
      data:
        variables:
          bedtime: false