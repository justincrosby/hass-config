platform: template
sensors:
  presence_everyone_home:
    value_template: '{{ is_state("binary_sensor.justin_presence", "on") and is_state("binary_sensor.jenni_presence", "on") and is_state("binary_sensor.jayden_presence", "on") }}'
    friendly_name: 'Is Everyone Home?'
  presence_anyone_home:
    value_template: '{{ is_state("binary_sensor.justin_presence", "on") or is_state("binary_sensor.jenni_presence", "on") or is_state("binary_sensor.jayden_presence", "on") }}'
    friendly_name: 'Is Anyone Home?'
  presence_should_activate:
    value_template: >
      {% if is_state("binary_sensor.justin_presence", "on") %}
        {{ is_state("binary_sensor.jenni_presence", "off") and is_state("binary_sensor.jayden_presence", "off") }}
      {% elif is_state("binary_sensor.jenni_presence", "on") %}
        {{ is_state("binary_sensor.justin_presence", "off") and is_state("binary_sensor.jayden_presence", "off") }}
      {% elif is_state("binary_sensor.jayden_presence", "on") %}
        {{ is_state("binary_sensor.justin_presence", "off") and is_state("binary_sensor.jenni_presence", "off") }}
      {% else %}
        true
      {% endif %}
    friendly_name: 'Should presence automation activate?'
  justin_presence:
    friendly_name: Justin Presence
    device_class: presence
    value_template: '{{ is_state("device_tracker.justins_phone_tracker", "home") }}'
    delay_off:
      minutes: 5
  jenni_presence:
    friendly_name: Jenni Presence
    device_class: presence
    value_template: '{{ is_state("device_tracker.jennis_phone_tracker", "home") }}'
    delay_off:
      minutes: 5
  jayden_presence:
    friendly_name: Jayden Presence
    device_class: presence
    value_template: '{{ is_state("device_tracker.jaydens_phone", "home") }}'
    delay_off:
      minutes: 5
  bedroom_presence:
    friendly_name: Bedroom Presence
    value_template: '{{ is_state("sensor.justins_phone_room_presence", "bedroom") or is_state("sensor.jennis_phone_room_presence", "bedroom") or is_state("binary_sensor.bedroom_sensor_home_security_motion_detection", "on") }}'
    delay_off:
      minutes: 5
